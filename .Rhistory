library(stm)
library(tidytext)
library(tidyverse)
# load data
rapid = load_csv("data/raw_data.csv")
# load data
rapid = read_csv("data/raw_data.csv")
setwd("~/Documents/GitHub/sjweston.github.io/content/post/stm")
# load data
rapid = read_csv("data/raw_data.csv")
# Chunk 1
setwd("~/Documents/GitHub/sjweston.github.io/content/post/stm")
# Chunk 2
library(stm)
library(tidytext)
library(tidyverse)
# load data
rapid = read_csv("data/raw_data.csv")
View(rapid)
# Chunk 1
setwd("~/Documents/GitHub/sjweston.github.io/content/post/stm")
# Chunk 2
library(stm)
library(tidytext)
library(tidyverse)
# load data
rapid = read_csv("data/raw_data.csv")
# Chunk 5
load("data/storage.Rdata")
storage$results
storage$results %>%
pivot_longer(cols = -K,
names_to = "metric",
values_to = "value")
storage$results %>%
pivot_longer(cols = -K,
names_to = "metric",
values_to = "value") %>%
filter(metric %in% c("lbound", "exclus", "residual", "semcoh"))
storage$results %>%
pivot_longer(cols = -K,
names_to = "metric",
values_to = "value") %>%
filter(metric %in% c("lbound", "exclus", "residual", "semcoh")) %>%
ggplot(aes(x = K, y = value, color = metric))
storage$results %>%
pivot_longer(cols = -K,
names_to = "metric",
values_to = "value") %>%
filter(metric %in% c("lbound", "exclus", "residual", "semcoh"))
# Plot all metrics
storage$results %>%
pivot_longer(cols = -K,
names_to = "metric",
values_to = "value") %>%
filter(metric %in% c("lbound", "exclus", "residual", "semcoh")) %>%
mutate(K = unlist(K))
# Plot all metrics
storage$results %>%
pivot_longer(cols = -K,
names_to = "metric",
values_to = "value") %>%
filter(metric %in% c("lbound", "exclus", "residual", "semcoh")) %>%
mutate(across(c(K,value), unlist)) %>%
ggplot(aes(x = K, y = value, color = metric)) +
geom_point() +
geom_line() +
facet_wrap(~metric, scales = "free") +
guides(color = "none")
# Chunk 1
setwd("~/Documents/GitHub/sjweston.github.io/content/post/stm")
# Chunk 2
library(stm)
library(tidytext)
library(tidyverse)
# load data
rapid = read_csv("data/raw_data.csv")
# Chunk 5
load("data/storage.Rdata")
# Chunk 6
# Plot all metrics
storage$results %>%
pivot_longer(cols = -K,
names_to = "metric",
values_to = "value") %>%
filter(metric %in% c("lbound", "exclus", "residual", "semcoh")) %>%
mutate(across(c(K,value), unlist)) %>%
ggplot(aes(x = K, y = value, color = metric)) +
geom_point() +
geom_line() +
facet_wrap(~metric, scales = "free") +
guides(color = "none")
# Chunk 8
load("data/topic_model08.Rdata")
load("data/topic_model14.Rdata")
load("data/topic_model18.Rdata")
# Extract theta (document-topic probabilities)
gamma_08 <- tidy(topic_model08, matrix = "gamma")
install.packages("tidytext")
install.packages("reshape2")
# Chunk 1
setwd("~/Documents/GitHub/sjweston.github.io/content/post/stm")
# Chunk 2
library(stm)
library(tidytext)
library(tidyverse)
# load data
rapid = read_csv("data/raw_data.csv")
# Chunk 5
load("data/storage.Rdata")
# Chunk 6
# Plot all metrics
storage$results %>%
pivot_longer(cols = -K,
names_to = "metric",
values_to = "value") %>%
filter(metric %in% c("lbound", "exclus", "residual", "semcoh")) %>%
mutate(across(c(K,value), unlist)) %>%
ggplot(aes(x = K, y = value, color = metric)) +
geom_point() +
geom_line() +
facet_wrap(~metric, scales = "free") +
guides(color = "none")
# Chunk 8
load("data/topic_model08.Rdata")
load("data/topic_model14.Rdata")
load("data/topic_model18.Rdata")
# Extract theta (document-topic probabilities)
gamma_08 <- tidy(topic_model08, matrix = "gamma")
# Extract theta (document-topic probabilities)
gamma_08 <- tidy(topic_model08, matrix = "gamma")
# Find dominant topic per document
gamma_08 %>%
group_by(document) %>%
slice_max(gamma) %>%
count(topic) %>%
arrange(desc(n))
gamma_08
gamma_08 %>%
group_by(document) %>%
slice_max(gamma)
# Find dominant topic per document
gamma_08 %>%
with_groups(document, slice_max, gamma) %>%
count(topic) %>%
arrange(desc(n))
# Find dominant topic per document
gamma_08 %>%
with_groups(document, slice_max, gamma) %>%
count(topic, .drop = FALSE) %>%
arrange(desc(n))
# Extract beta matrices (word-topic probabilities)
beta_08_w <- tidy(topic_model08, matrix = "beta") %>%
pivot_wider(values_from = beta, names_from = topic)
load("~/Documents/GitHub/sjweston.github.io/content/post/stm/data/cleaned.Rdata")
load("data/cleaned.Rdata")
install.packages("igraph")
beta_08_w %>%
with_groups(topic, top_n, beta, n = 10) %>%
filter(beta >= .02) %>%
mutate(topic = as.factor(topic)) %>%
ggplot(aes(x = reorder(term, beta), y = beta, fill = topic)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "Probability", x = NULL) +
guides(fill = "none") +
scale_fill_viridis_d() +
scale_y_continuous(breaks = seq(0, 1, .1)) +
facet_wrap(~topic, scales = "free") +
theme_pubr()
beta_08_w
tidy(topic_model08, matrix = "beta") %>%
with_groups(topic, top_n, beta, n = 10) %>%
filter(beta >= .02) %>%
mutate(topic = as.factor(topic)) %>%
ggplot(aes(x = reorder(term, beta), y = beta, fill = topic)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "Probability", x = NULL) +
guides(fill = "none") +
scale_fill_viridis_d() +
scale_y_continuous(breaks = seq(0, 1, .1)) +
facet_wrap(~topic, scales = "free") +
theme_pubr()
library(ggpubr)
tidy(topic_model08, matrix = "beta") %>%
with_groups(topic, top_n, beta, n = 10) %>%
filter(beta >= .02) %>%
mutate(topic = as.factor(topic)) %>%
ggplot(aes(x = reorder(term, beta), y = beta, fill = topic)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "Probability", x = NULL) +
guides(fill = "none") +
scale_fill_viridis_d() +
scale_y_continuous(breaks = seq(0, 1, .1)) +
facet_wrap(~topic, scales = "free") +
theme_pubr()
tidy(topic_model08, matrix = "beta") %>%
with_groups(topic, top_n, beta, n = 10) %>%
filter(beta >= .02) %>%
mutate(topic = as.factor(topic)) %>%
ggplot(aes(x = reorder(term, beta), y = beta, fill = topic)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "Probability", x = NULL) +
guides(fill = "none") +
scale_fill_viridis_d() +
scale_y_continuous(breaks = seq(0, 1, .1)) +
facet_wrap(~topic, scales = "free_y") +
theme_pubr()
ggsave(filename = "featured.jpg",scale = .5, width = 1200, height=800, units="px")
tidy(topic_model08, matrix = "beta") %>%
with_groups(topic, top_n, beta, n = 10) %>%
filter(beta >= .02) %>%
mutate(topic = as.factor(topic)) %>%
ggplot(aes(x = reorder(term, beta), y = beta, fill = topic)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "Probability", x = NULL) +
guides(fill = "none") +
scale_fill_viridis_d() +
scale_y_continuous(breaks = seq(0, 1, .1)) +
facet_wrap(~topic, scales = "free_y") +
theme_pubr()
ggsave(filename = "featured.jpg",scale = .5, width = 1200, height=800, units="px")
ggsave(filename = "featured.jpg",scale = 2, width = 1200, height=800, units="px")
ggsave(filename = "featured.jpg",scale = 2.3, width = 1200, height=800, units="px")
